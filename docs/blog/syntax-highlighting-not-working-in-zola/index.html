<!doctype html><html lang=ja><head><script src="https://www.googletagmanager.com/gtag/js?id=G-E98HG92E48" async></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-E98HG92E48')</script><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>Zola で Syntax Highlighting が機能しなかった問題とその解決方法 </title><link href="https://yusei-wy.github.io/ atom.xml" rel=alternate title=yusei-wy.github.io type=application/atom+xml><link href=https://yusei-wy.github.io/main.css media=screen rel=stylesheet><link href=https://yusei-wy.github.io/style.css media=screen rel=stylesheet><link href=https://yusei-wy.github.io/syntax-theme-dark.css rel=stylesheet><meta name=description><meta content="Zola で Syntax Highlighting が機能しなかった問題とその解決方法" property=og:title><meta content=article property=og:type><meta content=https://yusei-wy.github.io/blog/syntax-highlighting-not-working-in-zola/ property=og:url><meta property=og:description><meta content=yusei-wy.github.io property=og:site_name><meta content="default-src 'self' ws://127.0.0.1:1024/; img-src 'self' https://*; script-src 'self' https://www.googletagmanager.com/; style-src 'self'; font-src 'self'" http-equiv=Content-Security-Policy><body><div class=base-container><header class=header><div class=navbar><div class="nav-title nav-navs"><a class="nav-links home-title" href=https://yusei-wy.github.io>yusei-wy.github.io</a></div><nav class="socials nav-navs"><a class="nav-links social" rel="noopener noreferrer" href=https://twitter.com/yusei_wy target=_blank> <img alt=twitter src=/social_icons/twitter.svg title=twitter> </a><a class="nav-links social" rel="noopener noreferrer" href=https://github.com/yusei-wy/ target=_blank> <img alt=github src=/social_icons/github.svg title=github> </a><label class=theme-switcher for=themeswitch><div class=background></div> <input id=themeswitch type=checkbox> <div class=switch><img alt="theme switch to dark" class=moon src=/menu_icon/moon.png><img alt="theme switch to light" class=sun src=/menu_icon/sun.png></div></label></nav></div></header><main class="main content"><h1 class=title>Zola で Syntax Highlighting が機能しなかった問題とその解決方法</h1><p class=subtitle><strong>2023-03-14</strong><p>※この記事は Bing Chat で整形しました。<p>Zola で Syntax Highlighting が機能しなかった問題とその解決方法<p>Zola は静的サイトジェネレーターの一つです。Zola を使ってサイトを作成していたところ、Syntax Highlighting が機能しないという問題に遭遇しました。Syntax Highlighting とは、コードブロック内のキーワードなどに色を付けて見やすくする機能です。<p>この問題は、CSP (Content Security Policy) というセキュリティ機能が原因でした。CSP は、インラインのスタイル（style 属性）などを無効化することで、悪意のあるコードの実行を防ぐ機能です。しかし、Zola のデフォルト設定では、Syntax Highlighting のためにインラインのスタイルが出力されていました。そのため、CSP によって Syntax Highlighting が無効化されていたのです。<p>この問題を解決するには、以下の手順で Zola の設定ファイル（config.toml）を変更します。<ol><li>highlight_theme を "css" に変更します。これは、インラインのスタイルではなく、CSS のクラス名として出力することを指定します。<li>highlight_themes_css で出力するファイル名を指定します。ここでは "dracula-dark" と "dracula-light" というテーマ名とそれぞれ対応するファイル名（syntax-theme-dark.css と syntax-theme-light.css）を指定しています。<li>extra.stylesheets で外部ファイルとして出力されたファイル（syntax-theme-dark.css）を指定します。</ol><p>変更後の設定ファイルは以下のようになります。<pre class="language-toml z-code" data-lang=toml><code class=language-toml data-lang=toml><span class="z-source z-toml"><span class="z-comment z-line z-number-sign z-toml"><span class="z-punctuation z-definition z-comment z-toml">#</span>[markdown]</span>
<span class="z-invalid z-illegal z-toml">...</span>
<span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">highlight_theme</span></span><span class="z-punctuation z-definition z-key-value z-toml">=</span><span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>css<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span>
<span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">highlight_themes_css</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-array z-begin z-toml">[</span>
    <span class="z-punctuation z-definition z-inline-table z-begin z-toml">{</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">theme</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>dracula-dark<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-separator z-inline-table z-toml">,</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">filename</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>syntax-theme-dark.css<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span> <span class="z-punctuation z-definition z-inline-table z-end z-toml">}</span><span class="z-punctuation z-separator z-array z-toml">,</span>
    <span class="z-punctuation z-definition z-inline-table z-begin z-toml">{</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">theme</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>dracula-light<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-separator z-inline-table z-toml">,</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">filename</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>syntax-theme-light.css<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span> <span class="z-punctuation z-definition z-inline-table z-end z-toml">}</span><span class="z-punctuation z-separator z-array z-toml">,</span>
<span class="z-punctuation z-definition z-array z-end z-toml">]</span>

<span class="z-comment z-line z-number-sign z-toml"><span class="z-punctuation z-definition z-comment z-toml">#</span>[extra]</span>
<span class="z-invalid z-illegal z-toml">...</span>
<span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">stylesheets</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-array z-begin z-toml">[</span><span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>syntax-theme-dark.css<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-definition z-array z-end z-toml">]</span>
</span></code></pre><p>以上で Syntax Highlighting が機能するようになります。ただ配色は期待していた <code>dracula</code> 風ではなく原因がわかっていないため、なにわかれば追記します。</main><footer class=footer><section><nav><span classname=desktop-only>yusei-wy.github.io</span></nav></section><script src=https://yusei-wy.github.io/js/main.js></script></footer></div>